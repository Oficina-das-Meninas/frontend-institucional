<div class="flex">
  <div
    class="hidden lg:flex w-1/2 items-center justify-center bg-[#F5F5F5] p-12"
  >
    <div
      class="flex flex-col justify-center items-center w-full h-full text-center px-8"
    >
      <img
        alt="Meninas abraçando"
        class="mb-6 w-[48rem] h-[48rem] rounded-lg shadow-lg object-cover"
        src="./meninas-abraco.png"
      />
      <h2 class="text-4xl font-bold tracking-tight text-gray-900">
        Junte-se a nós para semear o futuro!
      </h2>
      <p class="mt-4 text-lg text-gray-600 max-w-md">
        Sua doação transforma a vida de meninas e jovens mulheres, oferecendo
        educação, oportunidades e um futuro mais brilhante. Cada contribuição,
        não importa o tamanho, faz uma diferença real.
      </p>
    </div>
  </div>

  <div
    class="flex flex-1 items-start justify-start px-6 py-[10rem] sm:items-center sm:justify-center sm:px-6 lg:px-12 lg:w-1/2"
  >
    <form
      class="flex flex-col gap-6 w-full"
      [formGroup]="form"
      (ngSubmit)="onSubmit()"
    >
      <div class="flex items-center gap-4 mb-6">
        <a
          routerLink="/"
          class="inline-flex cursor-pointer items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:bg-gray-100 h-10 w-10 text-gray-600"
        >
          <mat-icon>arrow_back</mat-icon>
        </a>

        <div class="flex-1 text-center">
          <h2 class="text-4xl font-semibold tracking-tight text-gray-900">
            Faça sua doação
          </h2>
          <p class="mt-2 text-gray-600">Sua contribuição faz a diferença!</p>
        </div>
      </div>

      @if(!userAuthenticated) {
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Nome completo</mat-label>
        <input formControlName="name" matInput placeholder="Digite seu nome" />
        @if(formHelper.getErrorMessage(form, 'name') ) {
        <mat-error>{{ formHelper.getErrorMessage(form, 'name') }}</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>E-mail</mat-label>
        <input
          formControlName="email"
          matInput
          placeholder="Digite seu e-mail"
        />
        @if(formHelper.getErrorMessage(form, 'email') ) {
        <mat-error>{{ formHelper.getErrorMessage(form, 'email') }}</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>CPF</mat-label>
        <input
          formControlName="document"
          matInput
          placeholder="000.000.000-00"
          mask="000.000.000-00"
        />
        @if(formHelper.getErrorMessage(form, 'document') ) {
        <mat-error
          >{{ formHelper.getErrorMessage(form, 'document') }}</mat-error
        >
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Telefone</mat-label>
        <input
          formControlName="phone"
          matInput
          placeholder="(00) 00000-0000"
          mask="(00) 00000-0000"
        />
        @if(formHelper.getErrorMessage(form, 'phone') ) {
        <mat-error>{{ formHelper.getErrorMessage(form, 'phone') }}</mat-error>
        }
      </mat-form-field>
      } @else {
      <div
        class="flex border justify-between rounded-sm p-5 border-[#D9D9D9] bg-[#F5F5F5]"
      >
        <div class="flex flex-col gap-2">
          <p>Nome: <strong>Maria Silva</strong></p>
          <p>E-mail: <strong>maria@email.com</strong></p>
          <p>CPF: <strong>0**.***.**-0*</strong></p>
          <p>Telefone: <strong>(00) 00000-0000</strong></p>
        </div>
        <a routerLink="perfil" class="text-[#DA235F]">Editar</a>
      </div>
      }

      <div class="space-y-4">
        <h3 class="text-lg font-medium text-gray-900">Adicione um valor *</h3>
        <div class="grid grid-cols-2 gap-4 sm:grid-cols-4">
          <button
            type="button"
            class="flex-1 rounded-md border py-3 px-4 text-center font-semibold transition-all cursor-pointer"
            (click)="setSelectedAmount(10)"
          >
            + R$10
          </button>

          <button
            type="button"
            class="flex-1 rounded-md border py-3 px-4 text-center font-semibold transition-all cursor-pointer"
            (click)="setSelectedAmount(50)"
          >
            + R$50
          </button>

          <button
            type="button"
            class="flex-1 rounded-md border py-3 px-4 text-center font-semibold transition-all cursor-pointer"
            (click)="setSelectedAmount(100)"
          >
            + R$100
          </button>

          <button
            type="button"
            class="flex-1 rounded-md border py-3 px-4 text-center font-semibold transition-all cursor-pointer"
            (click)="setSelectedAmount(200)"
          >
            + R$200
          </button>
        </div>
      </div>

      <mat-form-field appearance="outline" class="w-full" floatLabel="always">
        <mat-label>Ou digite um valor</mat-label>
        <span matPrefix class="px-4">R$&nbsp;</span>
        <input
          formControlName="amount"
          matInput
          placeholder="0,00"
          type="text"
          mask="separator.2"
          thousandSeparator="."
          decimalMarker=","
        />
        @if(formHelper.getErrorMessage(form, 'amount')) {
        <mat-error>{{ formHelper.getErrorMessage(form, 'amount') }}</mat-error>
        }
      </mat-form-field>

      <div class="space-y-4">
        <h3 class="text-lg font-medium text-gray-900">Frequência *</h3>
        <div class="flex flex-col gap-2">
          <div class="flex gap-4">
            <label
              class="flex flex-1 cursor-pointer items-center justify-center gap-3 rounded-md border border-gray-300 p-3 has-[:checked]:border-[#BA005C] has-[:checked]:bg-[#C7265B]/15 has-[:checked]:text-[#BA005C]"
            >
              <input
                formControlName="frequency"
                type="radio"
                name="frequency"
                value="once"
                checked
                class="absolute opacity-0"
              />
              <span class="font-medium">Uma vez</span>
            </label>

            <label
              class="flex flex-1 cursor-pointer items-center justify-center gap-3 rounded-md border border-gray-300 p-3 has-[:checked]:border-[#BA005C] has-[:checked]:bg-[#C7265B]/15 has-[:checked]:text-[#BA005C]"
            >
              <input
                formControlName="frequency"
                type="radio"
                name="frequency"
                value="monthly"
                class="absolute opacity-0"
                (click)="openDialog()"
              />
              <span class="font-medium">Mensal</span>
            </label>
          </div>

          <div class="text-right">
            <p class="text-xs text-gray-500">
              O plano mensal é válido por um ano.
            </p>
          </div>
        </div>
      </div>

      <div class="space-y-4">
        <ngx-recaptcha2
          #captchaElem
          [siteKey]="captchaKey"
          (reset)="handleReset()"
          (expire)="handleExpire()"
          [required]="true"
          (load)="handleLoad()"
          (success)="handleSuccess($event)"
          [useGlobalDomain]="false"
          formControlName="recaptcha"
        >
        </ngx-recaptcha2>
        @if(form.get('recaptcha')?.touched && form.get('recaptcha')?.invalid) {
        <mat-error>Campo obrigatório</mat-error>
        }
      </div>

      <button
        class="w-full rounded-md bg-[#BA005C] py-3 px-4 text-base font-semibold text-white shadow-sm transition-colors hover:bg-[#DA235F] focus:outline-none focus:ring-2 focus:ring-[#BA005C] focus:ring-offset-2 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"
        type="submit"
        [disabled]="loadingRequest"
      >
        Continuar para Pagamento
      </button>

      @if (!userAuthenticated) {
      <p class="text-center text-sm text-gray-500">
        Já tem uma conta?
        <a
          routerLink="login"
          class="font-medium text-[#BA005C] hover:text-[#C7265B]"
        >
          Faça login
        </a>
      </p>
      }
    </form>
  </div>
</div>
